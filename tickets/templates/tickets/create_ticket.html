{% extends 'tickets/base.html' %}
{% block title %}New Ticket{% endblock %}
{% block content %}

<form id="ticket-form" method="post" action="{% url 'create_ticket' %}" enctype="multipart/form-data">
{% csrf_token %}
<div class="container">
  <div class="row">
    <div class="col-md-3">
      <h1 class="t_header">New Ticket</h1>
    </div>
    
        <div class="col-md-6">
          <h5 class="pts_h5">Work complete?:
            <div class="form-check form-check-inline">
              <input class="form-check-input" type="checkbox" id="complete_true" name="complete" value="true">
              <label class="form-check-label" for="complete_true">Yes</label>
            </div>
            <div class="form-check form-check-inline">
              <input class="form-check-input" type="checkbox" id="complete_false" name="complete" value="false">
              <label class="form-check-label" for="complete_false">No</label>
            </div>
          </h5>
        </div>
      
  </div>
</div>

<div class="container">
  <div class="row">
    <div class="info-container col-sm-4">
      <div class="container">
        <div class="table-responsive my-5 mb-4">
          <table class="table table-striped">
            <tr>
              <th class="column1">Pay Week</th>
              <td class="column2">
                <input type="date" name="week" value="{{ ticket.week }}" class="form-control">
              </td>
            </tr>
            <tr>
              <th class="column1">Agreement/Job Number</th>
              <td class="column2">
                <input type="text" name="jobno" value="{{ ticket.jobno }}" class="form-control">
              </td>
            </tr>
            <tr>
              <th class="column1">Job/Customer</th>
              <td class="column2">
              <input type="text" name="jobname" value="{{ ticket.jobname }}" class="form-control">
              </td>
            </tr>
            <tr>
              <th class="column1">Address</th>
              <td class="column2">
                <input type="text" name="address" value="{{ ticket.address }}" class="form-control">
              </td>
            </tr>
            <tr>
                <th class="column1">City, State, ZIP</th>
                <td class="column2">
                  <div class="d-flex">
                    <input type="text" name="city" value="{{ ticket.city }}" class="form-control city-input">
                    <input type="text" name="state" value="{{ ticket.state }}" class="form-control sml-input">
                    <input type="text" name="zip" value="{{ ticket.zip }}" class="form-control sml-input">
                  </div>
                </td>
              </tr>
            <tr>
              <th class="column1">Day</th>
              <td>
                      <select name="day" class="form-select">
                        {% for option in form.fields.day.choices %}
                          <option value="{{ option.0 }}">{{ option.1 }}</option>
                        {% endfor %}
                      </select>
              </td>
            </tr>  
            <tr>
              <th class="column1">Hours</th>
              <td class="column2">
                <input type="number" name="hours" value="{{ ticket.hours }}" class="form-control">
              </td>
            </tr>  
          </table>
        </div>
      </div>
    </div>
    <div class="unit-info-container col-sm-8">
      <div class="container mb-4 mt-5" style="max-height: 200px; overflow: auto;">
        <table class="table table-striped">
          <tbody>
            <tr>
              <th class="column-unit col-1">Unit</th>
              <th class="column-unit col-1">Mfgr.</th>
              <th class="column-unit col-3">Model</th>
              <th class="column-unit col-3">Serial</th>
              <th class="column-unit col-1">Unit</th>
              <th class="column-unit col-1">#/Loc.</th>
            </tr>
            <tr>
              <td class="column-unit"><b>1</b></td>
              <td class="column-unit">
                <input type="text" name="man1" value="{{ ticket.man1 }}" class="form-control">
              </td>
              <td class="column-unit">
                <input type="text" name="model1" value="{{ ticket.model1 }}" class="form-control">
              </td>
              <td class="column-unit">
                <input type="text" name="serial1" value="{{ ticket.serial1 }}" class="form-control">
              </td>
              <td class="column-unit">
                <input type="text" name="unit1" value="{{ ticket.unit1 }}" class="form-control">
              </td>
              <td class="column-unit">
                <input type="text" name="loc1" value="{{ ticket.loc1 }}" class="form-control">
              </td>
            </tr>
            <tr>
              <td class="column-unit"><b>2</b></td>
              <td class="column-unit">
                <input type="text" name="man2" value="{{ ticket.man2 }}" class="form-control">
              </td>
              <td class="column-unit">
                <input type="text" name="model2" value="{{ ticket.model2 }}" class="form-control">
              </td>
              <td class="column-unit">
                <input type="text" name="serial2" value="{{ ticket.serial2 }}" class="form-control">
              </td>
              <td class="column-unit">
                <input type="text" name="unit2" value="{{ ticket.unit2 }}" class="form-control">
              </td>
              <td class="column-unit">
                <input type="text" name="loc2" value="{{ ticket.loc2 }}" class="form-control">
              </td>
            </tr>
            <tr>
              <td class="column-unit"><b>3</b></td>
              <td class="column-unit">
                <input type="text" name="man3" value="{{ ticket.man3 }}" class="form-control">
              </td>
              <td class="column-unit">
                <input type="text" name="model3" value="{{ ticket.model3 }}" class="form-control">
              </td>
              <td class="column-unit">
                <input type="text" name="serial3" value="{{ ticket.serial3 }}" class="form-control">
              </td>
              <td class="column-unit">
                <input type="text" name="unit3" value="{{ ticket.unit3 }}" class="form-control">
              </td>
              <td class="column-unit">
                <input type="text" name="loc3" value="{{ ticket.loc3 }}" class="form-control">
              </td>
            </tr>
          </tbody>
        </table>
      </div>
      <div class="row">
        <div class="col-sm-12">
          <input type="text" name="desc" class="desc-text form-control" style="width: 100%" placeholder="Description" value="{{ticket.desc}}">
        </div>
      </div>
    </div>
    <div class="reason-info-container">
      <div class="container container-form-checkboxes">
        <div class="d-flex flex-wrap">
          <div class="table-wrapper col-md-6">
            <table class="table table-bordered table-striped">
              <colgroup>
                <col style="width: 80%;">
                <col style="width: 20%;">
              </colgroup>
              <tbody>
                {% for field in reasons_form %}
                  <tr>
                    <td>
                      <div class="form-check">
                        <label for="{{ field.id_for_label }}" class="form-check-label" style="word-wrap: break-word;">
                          {{ field.label_tag }}
                        </label>
                      </div>
                    </td>
                    <td>
                      <div class="form-check">
                        {{ field }}
                      </div>
                    </td>
                  </tr>
                {% endfor %}
              </tbody>
            </table>
          </div>
          
          <div class="table-wrapper col-md-6">
            <table class="table table-bordered table-striped">
              <colgroup>
                <col style="width: 80%;">
                <col style="width: 20%;">
              </colgroup>
              <tbody>
                {% for field in equipment_form %}
                  <tr>
                    <td>
                      <div class="form-check">
                        <label class="form-check-label" for="{{ field.id_for_label }}" style="word-wrap: break-word;">
                          {{ field.label }}
                        </label>
                      </div>
                    </td>
                    <td>
                      <div class="form-check">
                        {{ field }}
                      </div>
                    </td>
                  </tr>
                {% endfor %}
              </tbody>
            </table>
          </div>
      </div>
    </div>
  
  
    <div class="container-fluid">
      <div class="row">
        <h3 class="pts_h3">Parts/Material
          <button type="button" onclick="addMatTableRow()" class="mat-add-row-btn btn btn-primary ml-2">Add row</button>
          <button id="delete-mat-rows-btn" type="button" class="mat-del-row-btn btn btn-danger ml-2">Delete Selected Rows</button>
        </h3>
      </div>
    </div>
    
    <div class="container-fluid">
      <div class="row mt-4">
        <div class="table-responsive col">
          <table class="table table-striped table-bordered">
            <thead>
              <tr>
                <th class="sm-col-mat"></th>
                <th class="sm-col-mat">Qty</th>
                <th class="col">Description</th>
                <th class="col">PO</th>
                <th class="col">Stock</th>
              </tr>
            </thead>
            <tbody id="mat-tbody">
              <!-- Example row for reference -->
              <tr id="mat-row-template" style="display:none;">
                <td><input type="checkbox" class="form-check-input" name="material-0-delete" /></td>
                <td><input type="text" class="form-control" name="material-0-qty" /></td>
                <td><input type="text" class="form-control" name="material-0-description" /></td>
                <td><input type="text" class="form-control" name="material-0-po" /></td>
                <td><input type="text" class="form-control" name="material-0-stock" /></td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>
    </div>
    
    <div class="container-fluid">
      <div class="row mt-4">
        <h3 class="pts_h3">Refrigerant
          <button type="button" onclick="addRefTableRow()" class="mat-add-row-btn btn btn-primary ml-2">Add row</button>
          <button id="delete-ref-rows-btn" type="button" class="mat-del-row-btn btn btn-danger ml-2">Delete Selected Rows</button>
        </h3>
      </div>
    </div>
    
    <div class="container-fluid col-sm-12 col-md-12 col-lg-12">
      <table class="table table-striped">
        <thead>
          <tr>
            <th></th>
            <th>Unit</th>
            <th>Type</th>
            <th>Qty</th>
            <th>Tracking</th>
            <th>New</th>
            <th>Recover</th>
            <th>Recycle</th>
            <th>Reclaim</th>
            <th>Reclaim Center</th>
            <th>PO</th>
          </tr>
        </thead>
        <tbody id="ref-tbody">
          <tr id="ref-row-template" style="display: none;">
            <td><input type="checkbox" class="form-check-input" name="refrigerant-0-delete" /></td>
            <td><input type="text" class="form-control" name="refrigerant-0-unit" /></td>
            <td><input type="text" class="form-control" name="refrigerant-0-type" /></td>
            <td><input type="text" class="form-control" name="refrigerant-0-qty" /></td>
            <td><input type="text" class="form-control" name="refrigerant-0-tracking" /></td>
            <td><input type="checkbox" class="form-check-input" name="refrigerant-0-new" /></td>
            <td><input type="checkbox" class="form-check-input" name="refrigerant-0-recover" /></td>
            <td><input type="checkbox" class="form-check-input" name="refrigerant-0-recycle" /></td>
            <td><input type="checkbox" class="form-check-input" name="refrigerant-0-reclaim" /></td>
            <td><input type="text" class="form-control" name="refrigerant-0-reclaim-center" /></td>
            <td><input type="text" class="form-control" name="refrigerant-0-po" /></td>
          </tr>
        </tbody>
      </table>
    </div>
    
<div class="repto container-fluid">
  <div class="row">
    <div class="col-lg-2">
      <h5>Report to: </h5>
    </div>
    <div class="col-lg-3">
      <input type="text" class="form-control" value="{{ ticket.report_to }}" readonly>
    </div>
    <div class="col-lg-1"></div>
    <div class="col-lg-2">
      <h5>Authorized by: </h5>
    </div>
    <div class="col-lg-3">
      <input type="text" class="form-control" value="{{ ticket.auth_by }}" readonly>
    </div>
  </div>
</div>

<div class="container-fluid">
  <div class="row">
    <div class="col-lg-6">
      <div class="row">
        <h3 class="pts_h3 col-sm-3">Customer Signature:</h3>
      </div>
      <div class="sig-field row">
        {{ form.cust_signature }}
      </div>
    </div>
    <div class="col-lg-6">
      <div class="row">
        <h3 class="pts_h3 col-sm-3">Technician Signature:</h3>
      </div>
      <div class="sig-field row">
        {{ form.tech_signature }}
      </div>
    </div>
  </div>
</div>

<div class="container-fluid">
  <div class="row">
    <h3 class="pts_h3 col-sm-3">Comments/notes:</h3>
  </div>
  <div class="row">
    <input type="text" class="cmnts form-control col-sm-6" value="{{ ticket.comments }}" readonly>
  </div>
</div>
<button type="submit" class="btn btn-primary mt-2">Submit</button>
</div>

</form>
<br>
<br>
<br>
<br>
<br>
{% endblock %}